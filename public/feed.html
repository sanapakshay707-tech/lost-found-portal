<!DOCTYPE html>
<html lang="en">
  <h2>üì∞ Lost & Found Feed</h2>
<p>Browse all recent claims submitted by users.</p>

<input type="text" id="searchInput" placeholder="Search by item..." style="padding:10px; width:250px; border-radius:8px; border:none; margin-bottom:20px;" />
<button onclick="searchFeed()" style="padding:10px 20px; border:none; border-radius:8px; background:#00c6ff; color:#fff; font-weight:bold;">Search</button>

<div class="feed" id="feedContainer"></div>

<head>
  <meta charset="UTF-8" />
  <title>Lost & Found Feed</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: #1e1e2f;
      color: #fff;
      padding: 20px;
    }
    h2 {
      color: #00c6ff;
      margin-bottom: 20px;
    }
    .feed {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
    }
    .card {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    .card h3 {
      margin: 0 0 10px;
      color: #00c6ff;
    }
    .card p {
      margin: 5px 0;
    }
    .logout {
      background: #ff9800;
      color: #fff;
      margin-top: 20px;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h2>üì∞ Lost & Found Feed</h2>
  <p>Browse all recent claims submitted by users.</p>
  card.innerHTML = `
  <h3>${claim.item}</h3>
  <p><strong>Description:</strong> ${claim.description || ''}</p>
  <p><strong>Status:</strong> ${claim.status}</p>
  <p><strong>User:</strong> ${claim.user?.name || 'Anonymous'}</p>
  ${claim.image ? `<img src="http://localhost:3000/uploads/${claim.image}" style="max-width:100%; border-radius:8px; margin-top:10px;" />` : ''}
`;


  <div class="feed" id="feedContainer"></div>

  <button class="logout" onclick="logout()">Logout</button>

  <script>
  const token = localStorage.getItem('token');

  if (!token) {
    alert("You must be logged in to view the feed.");
    window.location.href = "login.html";
  }

  async function fetchFeed(query = "") {
    try {
      const url = query 
        ? `http://localhost:3000/api/search?q=${encodeURIComponent(query)}`
        : `http://localhost:3000/api/feed`;

      const res = await fetch(url, {
        headers: { Authorization: `Bearer ${token}` }
      });
      const claims = await res.json();

      const container = document.getElementById('feedContainer');
      container.innerHTML = '';

      claims.forEach(claim => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <h3>${claim.item}</h3>
          <p><strong>Description:</strong> ${claim.description || ''}</p>
          <p><strong>Status:</strong> ${claim.status}</p>
          <p><strong>User:</strong> ${claim.user?.name || 'Anonymous'}</p>
        `;
        container.appendChild(card);
      });
    } catch (err) {
      console.error("‚ùå Error fetching feed:", err);
      alert("Failed to load feed.");
    }
  }

  function searchFeed() {
    const query = document.getElementById('searchInput').value;
    fetchFeed(query);
  }

  function logout() {
    localStorage.removeItem('token');
    localStorage.removeItem('role');
    window.location.href = "login.html";
  }

  // Initial load
  fetchFeed();
</script>

</body>
</html>
